<!DOCTYPE html>
<html>
<head>
    

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>Angular 基于列表类开发的列表组件 | wenyan&#39;s blog | Never give up yourself, nothing is imposible</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#2ca6cb">
    
    
    <meta name="keywords" content="Angular">
    <meta name="description" content="主要实现的功能​    排序、分页、过滤、自定义操作列、列表中根据数据展示相应图标、跳转详情页  ​     组件继承思想​    封装一个列表基类，派生类继承该类，复用基类的功能。 Constructor 构造函数​    如果派生类未声明构造函数，它将使用基类的构造函数。这意味着在基类构造函数注入的所有服务，子组件都能访问到。 生命周期方法不继承​    如果基类中包含生命周期钩子，如 ngO">
<meta property="og:type" content="article">
<meta property="og:title" content="Angular 基于列表类开发的列表组件">
<meta property="og:url" content="http://zhuwenyan.com/2020/05/24/angularlist/index.html">
<meta property="og:site_name" content="wenyan&#39;s blog">
<meta property="og:description" content="主要实现的功能​    排序、分页、过滤、自定义操作列、列表中根据数据展示相应图标、跳转详情页  ​     组件继承思想​    封装一个列表基类，派生类继承该类，复用基类的功能。 Constructor 构造函数​    如果派生类未声明构造函数，它将使用基类的构造函数。这意味着在基类构造函数注入的所有服务，子组件都能访问到。 生命周期方法不继承​    如果基类中包含生命周期钩子，如 ngO">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf779b12d9fa9?w=1273&h=764&f=png&s=95431">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf78143953f95?w=2333&h=1594&f=png&s=422427">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf78d4b661e4c?w=1043&h=129&f=png&s=8970">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf772f4bd76f9?w=335&h=396&f=png&s=20581">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf772eca2e820?w=846&h=332&f=png&s=39247">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf79c3d42251d?w=991&h=544&f=png&s=61021">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf79fed6a6ab6?w=1029&h=276&f=png&s=28737">
<meta property="article:published_time" content="2020-05-24T07:40:10.896Z">
<meta property="article:modified_time" content="2020-05-24T12:54:16.925Z">
<meta property="article:author" content="wenyan">
<meta property="article:tag" content="Angular">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2020/5/1/171cf779b12d9fa9?w=1273&h=764&f=png&s=95431">
    
        <link rel="alternate" type="application/atom+xml" title="wenyan&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    

<meta name="generator" content="Hexo 4.2.0"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">wenyan</h5>
          <a href="mailto:18319981182@163.com" title="18319981182@163.com" class="mail">18319981182@163.com</a>
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/zwy942652315" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Angular 基于列表类开发的列表组件</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menuShare">
            <i class="icon icon-lg icon-share-alt"></i>
        </a>
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">Angular 基于列表类开发的列表组件</h1>
        <h5 class="subtitle">
            
                <time datetime="2020-05-24T07:40:10.896Z" itemprop="datePublished" class="page-time">
  2020-05-24
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#主要实现的功能"><span class="post-toc-number">1.</span> <span class="post-toc-text">主要实现的功能</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#组件继承思想"><span class="post-toc-number">2.</span> <span class="post-toc-text">组件继承思想</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#Constructor-构造函数"><span class="post-toc-number">2.0.0.1.</span> <span class="post-toc-text">Constructor 构造函数</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#生命周期方法不继承"><span class="post-toc-number">2.0.0.2.</span> <span class="post-toc-text">生命周期方法不继承</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#继承的方法和属性基于可访问性级别"><span class="post-toc-number">2.0.0.3.</span> <span class="post-toc-text">继承的方法和属性基于可访问性级别</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#模板是不能被继承"><span class="post-toc-number">2.0.0.4.</span> <span class="post-toc-text">模板是不能被继承</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#元数据和装饰器不继承"><span class="post-toc-number">2.0.0.5.</span> <span class="post-toc-text">元数据和装饰器不继承</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#依赖注入"><span class="post-toc-number">2.0.0.6.</span> <span class="post-toc-text">依赖注入</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#实现过程"><span class="post-toc-number">3.</span> <span class="post-toc-text">实现过程</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#组件定义"><span class="post-toc-number">3.0.1.</span> <span class="post-toc-text">组件定义</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#自定义模板"><span class="post-toc-number">3.0.1.1.</span> <span class="post-toc-text">自定义模板</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#继承父类"><span class="post-toc-number">3.0.1.2.</span> <span class="post-toc-text">继承父类</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#重写父类方法"><span class="post-toc-number">3.0.1.3.</span> <span class="post-toc-text">重写父类方法</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#组件使用"><span class="post-toc-number">3.0.2.</span> <span class="post-toc-text">组件使用</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#公共组件的巧妙之处"><span class="post-toc-number">4.</span> <span class="post-toc-text">公共组件的巧妙之处</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#actionColumn-操作列可以自定义"><span class="post-toc-number">4.0.0.1.</span> <span class="post-toc-text">actionColumn 操作列可以自定义</span></a></li><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#过滤功能"><span class="post-toc-number">4.0.0.2.</span> <span class="post-toc-text">过滤功能</span></a></li></ol></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#最后"><span class="post-toc-number">5.</span> <span class="post-toc-text">最后</span></a></li></ol>
        </nav>
    </aside>


<article id="post-angularList"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Angular 基于列表类开发的列表组件</h1>
        <div class="post-meta">
            <time class="post-time" title="2020-05-24 15:40:10" datetime="2020-05-24T07:40:10.896Z"  itemprop="datePublished">2020-05-24</time>

            


            
<span id="busuanzi_container_page_pv" title="文章总阅读量" style='display:none'>
    <i class="icon icon-eye icon-pr"></i><span id="busuanzi_value_page_pv"></span>
</span>


        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="主要实现的功能"><a href="#主要实现的功能" class="headerlink" title="主要实现的功能"></a>主要实现的功能</h2><p>​    排序、分页、过滤、自定义操作列、列表中根据数据展示相应图标、跳转详情页</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf779b12d9fa9?w=1273&h=764&f=png&s=95431" alt></p>
<p>​    </p>
<h2 id="组件继承思想"><a href="#组件继承思想" class="headerlink" title="组件继承思想"></a>组件继承思想</h2><p>​    封装一个列表基类，派生类继承该类，复用基类的功能。</p>
<h5 id="Constructor-构造函数"><a href="#Constructor-构造函数" class="headerlink" title="Constructor 构造函数"></a>Constructor 构造函数</h5><p>​    如果派生类未声明构造函数，它将使用基类的构造函数。这意味着在基类构造函数注入的所有服务，子组件都能访问到。</p>
<h5 id="生命周期方法不继承"><a href="#生命周期方法不继承" class="headerlink" title="生命周期方法不继承"></a>生命周期方法不继承</h5><p>​    如果基类中包含生命周期钩子，如 <code>ngOnInit</code>、<code>ngOnChanges</code> 等，而在派生类没有定义相应的生命周期钩子，基类的生命周期钩子会被自动调用。如果需要在派生类触发<code>ngOnInit</code>，则需要在派生类上定义相应的生命周期钩子。</p>
<h5 id="继承的方法和属性基于可访问性级别"><a href="#继承的方法和属性基于可访问性级别" class="headerlink" title="继承的方法和属性基于可访问性级别"></a>继承的方法和属性基于可访问性级别</h5><p>​    派生类不能访问私有方法和属性，仅继承公共方法和属性。</p>
<h5 id="模板是不能被继承"><a href="#模板是不能被继承" class="headerlink" title="模板是不能被继承"></a>模板是不能被继承</h5><p>​    模板是不能被继承的 ，派生类需自定义模板，因此共享的 DOM 结构或行为需要单独处理。</p>
<h5 id="元数据和装饰器不继承"><a href="#元数据和装饰器不继承" class="headerlink" title="元数据和装饰器不继承"></a>元数据和装饰器不继承</h5><p>装饰器和元数据（<code>@Component</code>，<code>@Directive</code>，<code>@NgModule</code>等），这些元数据和装饰器不会被派生类继承，但是有一个例外，<code>@Input</code>和<code>@Output</code>装饰器会传递给派生类</p>
<h5 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h5><p>派生类必须通过调用super注入基类的参数</p>
<h2 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h2><p>application列表组件和基类<code>ResourceListBase</code>、<code>ResourceListWithStatuses</code> 关系</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf78143953f95?w=2333&h=1594&f=png&s=422427" alt></p>
<p>application列表组件主要继承父类<code>ResourceListWithStatuses</code>，通过重写<code>ResourceListWithStatuses</code>的方法，自定义模板，来复用父类的功能属性。</p>
<h4 id="组件定义"><a href="#组件定义" class="headerlink" title="组件定义"></a>组件定义</h4><h5 id="自定义模板"><a href="#自定义模板" class="headerlink" title="自定义模板"></a>自定义模板</h5><pre class=" language-ts"><code class="language-ts">@<span class="token function">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  selector<span class="token punctuation">:</span> <span class="token string">'sym-application-list'</span><span class="token punctuation">,</span>
  templateUrl<span class="token punctuation">:</span> <span class="token string">'./application.component.html'</span><span class="token punctuation">,</span>
  changeDetection<span class="token punctuation">:</span> ChangeDetectionStrategy<span class="token punctuation">.</span>OnPush<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<h5 id="继承父类"><a href="#继承父类" class="headerlink" title="继承父类"></a>继承父类</h5><p>通过expends继承父类</p>
<h5 id="重写父类方法"><a href="#重写父类方法" class="headerlink" title="重写父类方法"></a>重写父类方法</h5><p>通过继承基类<code>ResourceListWithStatuses</code>，可以复用其基本的功能属性，同时可以定义属性和方法扩展列表组件的功能，实现这个列表组件主要的是如果<strong>调用组件方法发起请求，获取到数据</strong></p>
<ul>
<li><p>重写<code>getResourceObservable</code> 方法，该方法主要是返回一个Observable，进行异步编程。</p>
<p>在这个方法里，可以请求多个api，使用Observable.forkJoin，可以合并多个Observable，返回一个Observable。</p>
</li>
<li><p>结合<code>sym-select</code> 组件搜索</p>
</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf78d4b661e4c?w=1043&h=129&f=png&s=8970" alt></p>
<p>  <code>sym-select</code>组件的namespace下拉列表的数据nsList是异步获取的，如果是选择是的namespace是ALL，那么列表组件要获取到nsList，然后对每个nsList里的namespace进行全部请求。如果选择的是某个namesapce，那么就传入namespace的值，进行单个请求</p>
<p>  <strong>这里也是比较疑惑的地方</strong>，之前想通过<code>@Input</code>传入属性的方式，来把搜索组件的数据传递给applicaiton列表组件<code>sym-application-list</code></p>
<p>  <img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf772f4bd76f9?w=335&h=396&f=png&s=20581" alt></p>
<p>  但是尝试之后，发现在页面初始化的时候，通过<code>@Input</code>的属性传入的<code>nsList</code>为空的。如果传入的属性是同步获取的，则可以传递到application列表组件中</p>
<p>  最后获取搜索参数的方式，采取<strong>服务依赖注入</strong>的方式来获取。</p>
<p>  <img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf772eca2e820?w=846&h=332&f=png&s=39247" alt></p>
<ul>
<li>通过重写map 方法，在自定义表格的数据，返回所需表格的数据。</li>
</ul>
<pre class=" language-ts"><code class="language-ts"><span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data_<span class="token punctuation">.</span>sortingDataAccessor <span class="token operator">=</span> <span class="token punctuation">(</span>item<span class="token punctuation">,</span> property<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">switch</span> <span class="token punctuation">(</span>property<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">case</span> <span class="token string">'name'</span><span class="token punctuation">:</span> <span class="token keyword">return</span> item<span class="token punctuation">.</span>objectMeta<span class="token punctuation">.</span>name<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'creationTimestamp'</span><span class="token punctuation">:</span> <span class="token keyword">return</span> item<span class="token punctuation">.</span>status<span class="token punctuation">.</span>creationTimestamp<span class="token punctuation">;</span>
        <span class="token keyword">case</span> <span class="token string">'namespace'</span><span class="token punctuation">:</span> <span class="token keyword">return</span> item<span class="token punctuation">.</span>objectMeta<span class="token punctuation">.</span>namespace<span class="token punctuation">;</span>
        <span class="token keyword">default</span><span class="token punctuation">:</span> <span class="token keyword">return</span> item<span class="token punctuation">[</span>property<span class="token punctuation">]</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getResourceObservable</span><span class="token punctuation">(</span>params<span class="token operator">?</span><span class="token punctuation">:</span> HttpParams<span class="token punctuation">)</span><span class="token punctuation">:</span> Observable<span class="token operator">&lt;</span>ApplicationList<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>localtionService_<span class="token punctuation">.</span>onNamespaceUpdate<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>namespace <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>localtionService_<span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>namespace<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>nsList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>localtionService_<span class="token punctuation">.</span><span class="token function">current</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>namespaceList<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> data<span class="token punctuation">:</span> <span class="token keyword">any</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
      items<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      listMeta<span class="token punctuation">:</span> <span class="token punctuation">{</span>
        totalItems<span class="token punctuation">:</span> <span class="token number">0</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>namespace <span class="token operator">===</span> <span class="token string">'ALL'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>nsList<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> observableList <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ns<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>application_<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>endpoint<span class="token punctuation">,</span> undefined<span class="token punctuation">,</span> ns<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>observableList <span class="token operator">&amp;&amp;</span> observableList<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
          observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        Observable<span class="token punctuation">.</span><span class="token function">forkJoin</span><span class="token punctuation">(</span>observableList<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
          res<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">,</span> index<span class="token punctuation">:</span> <span class="token keyword">number</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
            item<span class="token punctuation">.</span>items <span class="token operator">=</span> item<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
              v<span class="token punctuation">.</span>objectMeta<span class="token punctuation">.</span>namespace <span class="token operator">=</span> list<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>name<span class="token punctuation">;</span>
              <span class="token keyword">return</span> v<span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>items <span class="token operator">=</span> data<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>item<span class="token punctuation">.</span>items<span class="token punctuation">)</span><span class="token punctuation">;</span>
            data<span class="token punctuation">.</span>listMeta<span class="token punctuation">.</span>totalItems <span class="token operator">+</span><span class="token operator">=</span> item<span class="token punctuation">.</span>listMeta<span class="token punctuation">.</span>totalItems<span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>namespace <span class="token operator">!==</span> undefined<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>application_<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>endpoint<span class="token punctuation">,</span> undefined<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>namespace<span class="token punctuation">,</span> params<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Observable</span><span class="token punctuation">(</span><span class="token punctuation">(</span>observer<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
      observer<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">map</span><span class="token punctuation">(</span>applicationList<span class="token punctuation">:</span> ApplicationList<span class="token punctuation">)</span><span class="token punctuation">:</span> Application<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>namespace <span class="token operator">!==</span> <span class="token string">'ALL'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      applicationList<span class="token punctuation">.</span>items <span class="token operator">=</span> applicationList<span class="token punctuation">.</span>items<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>v<span class="token punctuation">:</span> <span class="token keyword">any</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        v<span class="token punctuation">.</span>objectMeta<span class="token punctuation">.</span>namespace <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>namespace<span class="token punctuation">;</span>
        <span class="token keyword">return</span> v<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'applicationList'</span><span class="token punctuation">,</span> applicationList<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> applicationList<span class="token punctuation">.</span>items<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">isInErrorState</span><span class="token punctuation">(</span>resource<span class="token punctuation">:</span> Application<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">boolean</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> resource<span class="token punctuation">.</span>status <span class="token operator">?</span> <span class="token punctuation">(</span>resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>replicas <span class="token operator">&amp;&amp;</span> resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>replicas <span class="token operator">!==</span> resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>availableReplicas <span class="token operator">?</span>
       <span class="token keyword">true</span> <span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">isInSuccessState</span><span class="token punctuation">(</span>resource<span class="token punctuation">:</span> Application<span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">boolean</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> resource<span class="token punctuation">.</span>status <span class="token operator">?</span> <span class="token punctuation">(</span>resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>replicas <span class="token operator">&amp;&amp;</span> resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>replicas <span class="token operator">===</span> resource<span class="token punctuation">.</span>status<span class="token punctuation">.</span>availableReplicas <span class="token operator">?</span>
       <span class="token keyword">true</span> <span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token keyword">false</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">protected</span> <span class="token function">getDisplayColumns</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token string">'statusicon'</span><span class="token punctuation">,</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token string">'namespace'</span><span class="token punctuation">,</span> <span class="token string">'labels'</span><span class="token punctuation">,</span> <span class="token string">'replicas'</span><span class="token punctuation">,</span> <span class="token string">'creationTimestamp'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span></code></pre>
<h4 id="组件使用"><a href="#组件使用" class="headerlink" title="组件使用"></a>组件使用</h4><pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>sym-application-list</span> <span class="token attr-name">#applicationList</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>sym-application-list</span><span class="token punctuation">></span></span></code></pre>
<p>初始化时，调用getList请求方法</p>
<pre class=" language-ts"><code class="language-ts"><span class="token keyword">this</span><span class="token punctuation">.</span>applicationList<span class="token punctuation">.</span><span class="token function">getList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h2 id="公共组件的巧妙之处"><a href="#公共组件的巧妙之处" class="headerlink" title="公共组件的巧妙之处"></a>公共组件的巧妙之处</h2><h5 id="actionColumn-操作列可以自定义"><a href="#actionColumn-操作列可以自定义" class="headerlink" title="actionColumn 操作列可以自定义"></a>actionColumn 操作列可以自定义</h5><p>在基类中已有声明注册操作列的方法，在application列表组件继承该方法，在构造函数中，注册操作列，<code>MenuComponent</code>是引入的组件</p>
<p><img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf79c3d42251d?w=991&h=544&f=png&s=61021" alt></p>
<pre><code>this.registerActionColumn&lt;MenuComponent&gt;(&#39;menu&#39;, MenuComponent);</code></pre><h5 id="过滤功能"><a href="#过滤功能" class="headerlink" title="过滤功能"></a>过滤功能</h5><p><img src="https://user-gold-cdn.xitu.io/2020/5/1/171cf79fed6a6ab6?w=1029&h=276&f=png&s=28737" alt></p>
<p>这里的Pods列表组件也是继承了<code>ResourceListWithStatuses</code></p>
<p>继承的组件都会继承过滤功能，因为继承的组件的模板是自定义的，可以在模板上引入过滤的组件</p>
<pre class=" language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>kd-card-list-filter</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>kd-card-list-filter</span><span class="token punctuation">></span></span></code></pre>
<p>基类中以判断是否有过滤组件，并订阅过滤组件的方法触发列表过滤</p>
<pre class=" language-ts"><code class="language-ts"><span class="token function">ngAfterViewInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data_<span class="token punctuation">.</span>sort <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>matSort_<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data_<span class="token punctuation">.</span>paginator <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>matPaginator_<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cardFilter_<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// 表格搜索</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>cardFilter_<span class="token punctuation">.</span>filterEvent<span class="token punctuation">.</span><span class="token function">subscribe</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> filterValue <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cardFilter_<span class="token punctuation">.</span>query<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data_<span class="token punctuation">.</span>filter <span class="token operator">=</span> filterValue<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span></code></pre>
<h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>​    通过继承一些列表组件或者基类，可以大大地提升组件功能的复用率，并且能够提高开发效率。在一些业务场景中，我们总会面临着，多处一样的代码，如果有变动，就要全部更改，这样不利于代码的简洁，而且代码逻辑相对单一。由此我们要学会封装一些常用性的组件，来达到代码的复用率，加强代码的健壮性。</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    最后更新时间：<time datetime="2020-05-24T12:54:16.925Z" itemprop="dateUpdated">2020-05-24 20:54:16</time>
</span><br>


        
        这里可以写作者留言，标签和 hexo 中所有变量及辅助函数等均可调用，示例：<a href="/2020/05/24/angularlist/" target="_blank" rel="external">http://zhuwenyan.com/2020/05/24/angularlist/</a>
        
    </div>
    
    <footer>
        <a href="http://zhuwenyan.com">
            <img src="/img/avatar.jpg" alt="wenyan">
            wenyan
        </a>
    </footer>
</blockquote>

        
<div class="page-reward">
    <a id="rewardBtn" href="javascript:;" class="page-reward-btn waves-effect waves-circle waves-light">赏</a>
</div>



        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Angular/" rel="tag">Angular</a></li></ul>


            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://zhuwenyan.com/2020/05/24/angularlist/&title=《Angular 基于列表类开发的列表组件》 — wenyan's blog&pic=http://zhuwenyan.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://zhuwenyan.com/2020/05/24/angularlist/&title=《Angular 基于列表类开发的列表组件》 — wenyan's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://zhuwenyan.com/2020/05/24/angularlist/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Angular 基于列表类开发的列表组件》 — wenyan's blog&url=http://zhuwenyan.com/2020/05/24/angularlist/&via=http://zhuwenyan.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://zhuwenyan.com/2020/05/24/angularlist/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2020/05/24/vue3beta/" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">vue 3 进入 beta 阶段</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2020/05/24/angularcreatenew/" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">Angular 新建页面流程</h4>
      </a>
    </div>
  
</nav>



    











    <!-- Valine Comments -->
    <div class="comments vcomment" id="comments"></div>
    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script>
    <!-- Valine Comments script -->
    <script>
        var GUEST_INFO = ['nick','mail','link'];
        var guest_info = 'nick,mail,link'.split(',').filter(function(item){
          return GUEST_INFO.indexOf(item) > -1
        });
        new Valine({
            el: '#comments',
            notify: 'false' == 'true',
            verify: 'false' == 'true',
            appId: "",
            appKey: "",
            avatar: "mm",
            placeholder: "Just go go",
            guest_info: guest_info.length == 0 ? GUEST_INFO : guest_info,
            pageSize: "10"
        })
    </script>
    <!-- Valine Comments end -->










</article>

<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        谢谢大爷~
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" src="/img/wechat.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check"
                data-wechat="/img/wechat.png" data-alipay="/img/alipay.jpg">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechat">微信</span>
                <span class="reward-toggle-label"></span>
                <span class="reward-toggle-item alipay">支付宝</span>
            </div>
        </label>
        
    </div>
</div>



</div>

        <footer class="footer">
    <!-- <div class="top">
        
<p>
    <span id="busuanzi_container_site_uv" style='display:none'>
        站点总访客数：<span id="busuanzi_value_site_uv"></span>
    </span>
    <span id="busuanzi_container_site_pv" style='display:none'>
        站点总访问量：<span id="busuanzi_value_site_pv"></span>
    </span>
</p>


        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>博客内容遵循 <a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
        </p>
    </div> -->
    <div class="bottom">
        <p><span>wenyan &copy; 2019 - 2020</span>
            <!-- <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span> -->
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=http://zhuwenyan.com/2020/05/24/angularlist/&title=《Angular 基于列表类开发的列表组件》 — wenyan's blog&pic=http://zhuwenyan.com/img/avatar.jpg" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=http://zhuwenyan.com/2020/05/24/angularlist/&title=《Angular 基于列表类开发的列表组件》 — wenyan's blog&source=" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=http://zhuwenyan.com/2020/05/24/angularlist/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Angular 基于列表类开发的列表组件》 — wenyan's blog&url=http://zhuwenyan.com/2020/05/24/angularlist/&via=http://zhuwenyan.com" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=http://zhuwenyan.com/2020/05/24/angularlist/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p>扫一扫，分享到微信</p>
    <img src="//api.qrserver.com/v1/create-qr-code/?data=http://zhuwenyan.com/2020/05/24/angularlist/" alt="微信分享二维码">
</div>




    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>






<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>



<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'wenyan'blog';
            clearTimeout(titleTime);
        } else {
            document.title = 'wenyan'blog';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
